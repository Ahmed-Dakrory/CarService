<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/dashboard2.xhtml">


	<ui:define name="title"> Prime International Shipping LLC</ui:define>


<ui:define name="mainHead"> 
			       <ul class="mn-sub"><li class="mn-sub-item mn-item-vendors"><a href="vitView.jsf" class="mn-sub-item-current"><b>Vehicle List</b></a></li></ul>
           <link rel="stylesheet" href="#{resource['css:dashboardPrime/all.min.css']}" />
		<link rel="stylesheet" href="#{resource['css:dashboardPrime/bootstrap.min.css']}" />
		
			</ui:define>
			
			
	<ui:define name="content">
	<style>
	table {
    border-collapse: inherit;
    /* border-spacing: 0; */
    /* border-radius: 11px; */
}

.aForHead{
color:white;
}


.aForHead:hover{
color:#ffec08;
}
	</style>
	
	 <p:panel id="mainPanel" class="container">
	#{carBean.openImageLink()} 	
	 
	 <div class="row">
	 	<div class="col-md-12">
	 	<h1>All Images for the freight: #{carBean.selectedCar.uuid}</h1>
	 	</div>
	 	
 	</div>
	 <div class="row mt-3">
	 	<div class="col-md-2 ml-5">
		 	<a href="/pages/secured/userData/vehicleList.jsf?faces-redirect=true" class="w-100 ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn btn-default">Back</a>
		 </div>
		 
		 
		 
		 <div class="col-md-2 ml-5">
		 	<a onclick="downloadAllFiles()" href="javascript:void(0)" class="w-100 ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn btn-default">Download All</a>
		 </div>
	 	
	 
	 </div>
	 
	 
	 <div class="accordion container" id="accordionExample">
	 
	 
	 
	 
	  <div class="card row">
	    <div class="card-header w-100" id="headingOne">
	       <h5 class="mb-0 bg-primary" style=" padding: 14px; border-bottom-style: double; ">
	        <a  class="aForHead" href="javascript:void(0)" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
	         	All Images
	        </a>
	      </h5>
	    </div>
	
	    <div id="collapseOne" class="collapse show in" aria-labelledby="headingOne" data-parent="#accordionExample">
	      <div class="card-body">
	      		<div class="row mt-1">
				 	<div class="col-md-2">
					 	<a onclick="downloadAllImages();" href="javascript:void(0)" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn btn-default">Download All Images</a>
					 </div>
				 </div>
	 			<div class="row mt-1">
	      	 		<!-- All images -->
	 
	 					<ui:repeat var="var" value="#{carBean.images}">
    <div class="col-md-3" style="border: black;border-style: solid;border-width: 1px;margin: 7px;">			
				
                    <div class="row" style=" text-align: center; ">
                        
                             <div class="row">
                                    <a href="javascript:void(0)" onclick='ViewDocById("#{var}")'>
                                        <h:graphicImage value="/images/?file=#{var}" alt="image#{var}" style="border-width:0px;width: 151px;height: 109px;"/></a>
                                </div>
                        
                        <div class="row">
                                <a style="color: Black;" href="javascript:void(0)" onclick='ViewDocById("#{var}")'>
                                    <span id="ctl00_BodyHolder_imageList_imageList_ctl00_docName">#{var}</span></a>
                                
                           </div>
                   </div>
               </div>
                
                
               
		</ui:repeat>
					 <!-- All images -->
					</div>
		
		 
	      </div>
	    </div>
	  </div>
	  <div class="card row">
	     <div class="card-header w-100" id="headingOne">
	      <h5 class="mb-0 bg-primary" style=" padding: 14px; border-bottom-style: double; ">
	        <a  class="aForHead" href="javascript:void(0)" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
	          All Images Loading
	        </a>
	      </h5>
	    </div>
	    <div id="collapseTwo" class="collapse show in" aria-labelledby="headingTwo" data-parent="#accordionExample">
	      <div class="card-body">
	      		<div class="row mt-1">
				 	<div class="col-md-2">
					 	<a onclick="downloadAllLoading();" href="javascript:void(0)" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn btn-default">Download All Loading Images</a>
					 </div>
				 </div>
	 			<div class="row mt-1">
	      	 		<!-- All images -->
	 
	 					<ui:repeat var="var" value="#{carBean.loadingImages}">
    <div class="col-md-3" style="border: black;border-style: solid;border-width: 1px;margin: 7px;">			
				
                    <div class="row" style=" text-align: center; ">
                        
                             <div class="row">
                                    <a href="javascript:void(0)" onclick='ViewDocById("#{var}")'>
                                        <h:graphicImage value="/images/?file=#{var}" alt="image#{var}" style="border-width:0px;width: 151px;height: 109px;"/></a>
                                </div>
                        
                        <div class="row">
                                <a style="color: Black;" href="javascript:void(0)" onclick='ViewDocById("#{var}")'>
                                    <span id="ctl00_BodyHolder_imageList_imageList_ctl00_docName">#{var}</span></a>
                                
                           </div>
                   </div>
               </div>
                
                
               
		</ui:repeat>
					 <!-- All images -->
					</div>
		
		 
	      </div>
	    </div>
	  </div>








	<div class="card row">
	     <div class="card-header w-100" id="headingFour">
	      <h5 class="mb-0 bg-primary" style=" padding: 14px; border-bottom-style: double; ">
	        <a  class="aForHead" href="javascript:void(0)" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
	          All Images 3D 
	        </a>
	      </h5>
	    </div>
	    <div id="collapseFour" class="collapse show in" aria-labelledby="headingFour" data-parent="#accordionExample">
	      <div class="card-body" style="padding:30px;">
	      		
	      	<p:panel id="panelToreload">
	      		<div class="row" style="width: 100%;margin-bottom: 19px;/* padding: 27px; */box-shadow: 4px -2px 27px 6px grey;border-radius: 15px;">
					<div class="card-header w-100" >
				      <h3 class="mb-0 bg-white" style="  text-align: center; font-size: 23px;">
				      Your Selection
				      </h3>
			      </div>
					<div class="w-100 border rounded">
						<div id="panoImage" style="background-color: rgb(0, 0, 0);width: 100%;height: 559px;"></div>
					</div>
				</div>
				
				<script>

					panoImage = document.querySelector('#panoImage');
	
					panorama = new PANOLENS.ImagePanorama('/images?file=#{carBean.image3DLink}');
					viewer = new PANOLENS.Viewer({
						container:panoImage
					}
					);
					viewer.add( panorama );
				</script>
				</p:panel>
	
	
	 			<div class="row mt-1">
	      	 		<!-- All images -->
	 
	 					<ui:repeat var="var" value="#{carBean.images3D}">
    <div class="col-md-3" style="border: black;/* border-style: solid; */border-width: 1px;margin: 7px;">			
				
                    <div class="row" style=" text-align: center; ">
                        
                             <div class="row">
                                    <a href="javascript:void(0)" onclick='View3DyId("#{var}")'>
                                        <h:graphicImage value="/images/?file=#{var}" alt="image#{var}" style="border: black;box-shadow: 5px 2px 11px 1px grey;border-radius: 11px;height: 110px;"/></a>
                                </div>
                        
                        <div class="row">
                                <a style="color: Black;" href="javascript:void(0)" onclick='ViewDocById("#{var}")'>
                                    <span id="ctl00_BodyHolder_imageList_imageList_ctl00_docName">#{var}</span></a>
                                
                           </div>
                   </div>
               </div>
                
                
               
		</ui:repeat>
					 <!-- All images -->
					</div>
		
		 
	      </div>
	    </div>
	  </div>







	<p:panel class="card row" rendered="#{carBean.selectedCar.exteriorExists}">
	<div class="card row">
	     <div class="card-header w-100" id="headingFive">
	      <h5 class="mb-0 bg-primary" style=" padding: 14px; border-bottom-style: double; ">
	        <a  class="aForHead" href="javascript:void(0)" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
	          Exterior View
	        </a>
	      </h5>
	    </div>
	    <div id="collapseFive" class="collapse show in" aria-labelledby="headingFive" data-parent="#accordionExample">
	      <div class="card-body" style="padding:30px;">
	      
	 			<div class="row mt-1">
	      	 		<!-- All images -->
	 				<canvas id="exteriorImg" width="640" height="480" style="border-radius: 15px;border: 1px solid rgb(211, 211, 211);box-shadow: 2px 5px 10px 5px grey;">
						Your browser does not support the HTML5 canvas tag.
					</canvas>
	 				 <!-- All images -->
				</div>
		
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" ></script>
<script>
$.noConflict();
</script>
		<h:outputScript name="js/dashboard2/assets/jquery-ui.min.js"/>
		<h:outputScript name="js/dashboard2/assets/threed_exterior.js"/>
<script>


createElement3d("exteriorImg","https://primeshippingllc.com/images?file=#{carBean.selectedCar.exteriorImg}")
</script>
		 
	      </div>
	    </div>
	  </div>
	
	</p:panel>
		
	
	
		
	
	  <div class="card row">
	     <div class="card-header w-100" >
	      <h5 class="mb-0 bg-primary" style=" padding: 14px; border-bottom-style: double; ">
	        <a  class="aForHead" href="javascript:void(0)" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
	          All Images 360
	        </a>
	      </h5>
	    </div>
	    <div id="collapseThree" class="collapse show in" aria-labelledby="headingThree" data-parent="#accordionExample">
	      <div class="card-body">
	      		<div class="row mt-1">
				 	<div class="col-md-2">
					 	<a onclick="downloadAll360();" href="javascript:void(0)" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only btn btn-default">Download All 360D Images</a>
					 </div>
				 </div>
	 			<div class="row mt-1">
	      	 		<!-- All images -->
	 
		
		<div id="spinCarContainer" class="row mt-2">

			  	 <br></br>
			  	 
			  	 <div id="container"> <!-- Use this container to position, size or style the widget. -->
			<div class="sts-spin"> <!-- This container allows the widget's "full screen" button to work. -->
			<iframe id="spinCar" style="width: 100%;height: 751px; " />
			</div>
			</div>
		</div>
		
		<div id="spinCarContainerFalse" style="display:none;">
		 <h1 class="w-100 text-center"> No 360 View Available for this car </h1>
		</div>
		
	 				 <!-- All images -->
					</div>
		
		 
	      </div>
	    </div>
	  </div>
	
	
	
	 </div>
	
		<h:form>
			<p:remoteCommand name="open3DImage" action="#{carBean.open3DImage()}"> 
	                                	</p:remoteCommand>
        </h:form>
                    	
		<h:outputScript name="js/dashboardPrime/popper.min.js"/>
		<h:outputScript name="js/dashboardPrime/bootstrap.min.js"/>
		<h:outputScript name="js/dashboardPrime/FileSaver.js"/>
		<h:outputScript name="js/dashboardPrime/jszip.js"/>
		
		<script src="https://pchen66.github.io/js/three/three.min.js"></script>
<script src="https://pchen66.github.io/js/panolens/panolens.min.js"></script>
		
		
		<script>

$('#panelToreload').hide();
</script>

		<script>
		
		
function downloadEachImage(urlFileName){
			
			const imageUrl = '/images/?file='+urlFileName;

			// Fetch the image and parse the response stream as a blob
			const imageBlob = fetch(imageUrl).then(response => Promise.resolve(response.blob()));

			return imageBlob;
			
		}
		
		
		
function downloadEachImageOutSide(urlFileName){
			
			const imageUrl = urlFileName;

			// Fetch the image and parse the response stream as a blob
			const imageBlob = fetch(imageUrl).then(response => Promise.resolve(response.blob()));

			return imageBlob;
			
		}
		



function downloadAllImages(){
			
			var zip = new JSZip();
			var img = zip.folder("Images");
			<ui:repeat var="variable" value="#{carBean.images}">
			filename="#{variable}";
			imgData = downloadEachImage(filename);
			img.file(filename, imgData);
			</ui:repeat>
			zip.generateAsync({type:"blob"})
			.then(function(content) {
			    // see FileSaver.js
			    saveAs(content, "All ImagesOf freight with Vin #{carBean.selectedCar.uuid}.zip");
			});

		}
		
		
function downloadAll360(){
	
	
	var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://find-spin-api.spincar.com/image-syndication/v2/customer/6628",
  "method": "POST",
  "headers": {
    "content-type": "application/json",
    "client-id": "Primeshippingimages",
    "auth": "a3648405a4447e6ef7f2cf9ef9af4f6e6ba8402d0d8e0470490a5faefebbfe4de86a2714e97d90dfed8869b24b90612454fceb266c42f8b37d6fe77aada04287",
    "cache-control": "no-cache",
    "postman-token": "03908bd6-6ebd-97ba-fdc1-b7fea156f87f"
  },
  "processData": false,
  "data": "\n{\n\"ids\" : \n[\"1Z87482434326\",\"#{carBean.selectedCar.uuid}\"]\n,\n\"allow_no_exterior\": true,\n\"include_third_party_closeups\": false,\n\"include_image_type\": false,\n\"include_raw_images\": false\n}"
}

$.ajax(settings).done(function (response) {
var zip = new JSZip();
	var img = zip.folder("Images3D");
	
images3D = response['vehicles'][0]['images'];
  
  $.each(images3D, function (key, val) {
		filename=val['url'];
	imgData = downloadEachImageOutSide(filename);
	img.file(val['label']+".jpg", imgData);
	
    });
	
	
	zip.generateAsync({type:"blob"})
	.then(function(content) {
	    // see FileSaver.js
	    saveAs(content, "All Images3D Of freight with Vin #{carBean.selectedCar.uuid}.zip");
	});
	
});

	
	
	
	

}
		
		
		
		
function downloadAllLoading(){
	
	var zip = new JSZip();
	var img = zip.folder("Loading Images");
	<ui:repeat var="variable" value="#{carBean.loadingImages}">
	filename="#{variable}";
	imgData = downloadEachImage(filename);
	img.file(filename, imgData);
	</ui:repeat>
	zip.generateAsync({type:"blob"})
	.then(function(content) {
	    // see FileSaver.js
	    saveAs(content, "All Loading Images Of freight with Vin #{carBean.selectedCar.uuid}.zip");
	});

}
	
		
		function downloadAllFiles(){
		
		
		
		
	var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://find-spin-api.spincar.com/image-syndication/v2/customer/6628",
  "method": "POST",
  "headers": {
    "content-type": "application/json",
    "client-id": "Primeshippingimages",
    "auth": "a3648405a4447e6ef7f2cf9ef9af4f6e6ba8402d0d8e0470490a5faefebbfe4de86a2714e97d90dfed8869b24b90612454fceb266c42f8b37d6fe77aada04287",
    "cache-control": "no-cache",
    "postman-token": "03908bd6-6ebd-97ba-fdc1-b7fea156f87f"
  },
  "processData": false,
  "data": "\n{\n\"ids\" : \n[\"1Z87482434326\",\"#{carBean.selectedCar.uuid}\"]\n,\n\"allow_no_exterior\": true,\n\"include_third_party_closeups\": false,\n\"include_image_type\": false,\n\"include_raw_images\": false\n}"
}

$.ajax(settings).done(function (response) {
var zip = new JSZip();
	var img = zip.folder("Images3D");
	
images3D = response['vehicles'][0]['images'];
  
  $.each(images3D, function (key, val) {
		filename=val['url'];
	imgData = downloadEachImageOutSide(filename);
	img.file(val['label']+".jpg", imgData);
	
    });
	
	
	
var img = zip.folder("Images");
			<ui:repeat var="variable" value="#{carBean.images}">
			filename="#{variable}";
			imgData = downloadEachImage(filename);
			img.file(filename, imgData);
			</ui:repeat>
			
			
			
			
			
			
			
			zip.generateAsync({type:"blob"})
			.then(function(content) {
			    // see FileSaver.js
			    saveAs(content, "#{carBean.selectedCar.uuid}.zip");
			});
			
	
	
});

	
	
	
	

	
	
			
		}
		</script>
		
		
		
		
		
		<!-- End of All Images -->
	 </p:panel>
     
     
     
     
     
		
	</ui:define>
	
		
	
</ui:composition>
</html>