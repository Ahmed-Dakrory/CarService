<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/dashboard2.xhtml">


	<ui:define name="title"> ADAWLIAA</ui:define>

	<ui:define name="content">
	
	<style>
	table {
    border-collapse: inherit;
    /* border-spacing: 0; */
    /* border-radius: 11px; */
}
td {
    /* font-weight: 400; */
    font-size: 95%;
    font-family: arial;
    text-align: -webkit-center;
}

.ui-panel .ui-panel-content {
    border: 0;
    background: 0;
    padding: .5em 1em;
    text-align: -webkit-center;
}
.mainLabels {
    font-size: 28px;
    font-family: serif;
    color: #757575;
    border: black;
    border-style: solid;
    border-color: #e8e8e8;
    border-width: 1px;
    padding: 3%;
    background: #fdfdfd;
    width: 67%;
    border-radius: 13px;
    box-shadow: 2px 0px 1px #b9b9b9, 0 0 21px #ffffff, 0 0 3px #2f2f2f;
    text-shadow: 1px 1px 2px black, 0 0 25px white, 0 0 5px #cacaca;
}

.displayText {
        font-size: 25px;
    font-family: serif;
    color: #757575;
    border: black;
    border-style: solid;
    border-color: #e8e8e8;
    border-width: 1px;
    background: #fdfdfd;
    width: min-content;
    border-radius: 155px;
    box-shadow: 2px 0px 1px #b9b9b9, 0 0 21px #ffffff, 0 0 3px #2f2f2f;
    text-shadow: 1px 1px 2px black, 0 0 25px white, 0 0 5px #cacaca;
    margin-top: 1%;
    padding: 49px;
    padding-top: 65px;
    padding-bottom: 65px;
    margin-left: 16%;
    text-align: center;
}
.textBoxStyle{
    width: 50%;
    height: 35px;
    font-size: 17px;
    border-radius: 9px;
    font-family: serif;
    padding: 1%;
}

.BankHead{
    width: 50%;
    text-align: initial;
    margin-top: 1%;
}

.text-primary {
    color: #0088cc !important;
}


 .h2 {
    font-size: 24px;
    font-weight: 700;
    color: #000;
    margin: 10px 0;
    text-align: center;
}




#checkout-button {
width: 400px;
  height: 112px;
  border-radius: 6px!important;
  justify-content: space-between;
  height: 36px;
  background: #556cd6;
  color: white;
  width: 100%;
  font-size: 14px;
  border: 0;
  font-weight: 500;
  cursor: pointer;
  letter-spacing: 0.6;
  border-radius: 0 0 6px 6px;
  transition: all 0.2s ease;
  box-shadow: 0px 4px 5.5px 0px rgba(0, 0, 0, 0.07);
}
#checkout-button:hover {
  opacity: 0.8;
}



	</style>
	
	
	 <script src="https://www.paypal.com/sdk/js?client-id=AfJLLJtGEwfl6Hye0lNyGe7Sm-OoqHu-Duhln5rwdfd9NCuldziZOsD_A8nt2zbVznmhVPJt5Qpw1ps3"></script>
	 
	 <!-- Trial
	 <script src="https://www.paypal.com/sdk/js?client-id=AYJafdGM8WMc40tom1a26q7kGrxKdqIp1eH5a-MPCMI-_oTfuWromWMsl6OpzbMaWT3HxywgJFIxtwCr"></script>
	
	-->

 <script src="https://polyfill.io/v3/polyfill.min.js?version=3.52.1"></script>
    <script src="https://js.stripe.com/v3/"></script>
  
<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css"></link>
   
#{loginBean.refresh()}
#{carBean.filterCarToGetTotalMoneyBox()}

	  <h:form id="aspnetForm">
	  
	  
<div class="col-sm-12 col-md-10" style="border-radius: 7px;margin: 51px;box-shadow: 2px 0px 1px #b9b9b9, 0 0 21px #ffffff, 0 0 3px #733838;">

<div class="container bootstrap snippets bootdey" >
  <div class="row">
      <div class="col-md-12">
      <div class="">
      <div class="panel-body">
                  <div class="row">
                        <div class="col-xs-12 col-sm-8">
                            <h2 class="text-primary"><b><span class="glyphicon glyphicon-user"></span> Welcome #{loginBean.theUserOfThisAccount.firstName} #{loginBean.theUserOfThisAccount.lastName} Client ##{loginBean.theUserOfThisAccount.id} </b></h2>
                            <div class="">
                            	<div class="row">
                            		 <div class="col-xs-12 col-sm-4">
			                            <h2><strong> $#{loginBean.thisAccountMoneyBox.depositedMoney} </strong></h2>                    
			                            <p class="btn btn-success btn-block"><span class="fa fa-dollar"></span><small>The deposited Amount</small></p>
			                        </div><!--/col-->
			                        <div class="col-xs-12 col-sm-4">
			                            <h2><strong>$#{loginBean.thisAccountMoneyBox.totalUsed}</strong></h2>                    
			                            <p class="btn btn-info btn-block"><span class="fa fa-dollar"></span><small>The Used Amount</small></p>
			                        </div><!--/col-->
			                        <div class="col-xs-12 col-sm-4">
			                            <h2><strong>$#{carBean.totalPrice}</strong></h2>                    
			                            <p class="btn btn-info btn-block"><span class="fa fa-dollar"></span><small>Total Cars Cost</small></p>
			                        </div><!--/col-->
			                        <div class="col-xs-12 col-sm-4">
			                            <h2><strong>$#{loginBean.thisAccountMoneyBox.depositedMoney-loginBean.thisAccountMoneyBox.totalUsed}</strong></h2>                    
			                            <p class="btn btn-primary btn-block"><span class="fa fa-dollar"></span><small>The available Amount</small></p>
			                        </div>
                            	</div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4">
                        	<p style="    font-size: 25px;    font-family: serif;"> Your Account is #{loginBean.thisAccountMoneyBox.active?'Active':'Not Active'}</p>
			  				<p style="  display:#{loginBean.thisAccountMoneyBox.active?'none':'contents'};   text-shadow: 1px 1px 2px white, 0 0 25px white, 0 0 5px #cacaca;">To Activate Your Account you have to send email to us</p>
	                        <p:graphicImage style="    width: 172px;" value="/resources/imgs/#{loginBean.thisAccountMoneyBox.active?'correct':'error'}.png"></p:graphicImage>
		  		
		  					<!-- <p:commandButton rendered="#{!loginBean.thisAccountMoneyBox.active}" disabled="#{loginBean.thisAccountMoneyBox.active}" class="btn btn-default DTTT_button_print" value="Activate the account" action="#{loginBean.activateMyAccount}"/>
	  							 -->
                        </div>

                       <!--/col-->
                  </div><!--/row-->
                  
                  <div class="row">
                  	
<div id="ajax-content">

<div class="sort-boxes-account">


	  <table  style="width:100%;padding: 5%;">
	  	
	  	
	  	<tr>
	  		<td>
	  				<br></br>
	  				<p class="BankHead">Bank Name</p>
	  				<p:inputText value="#{loginBean.thisAccountMoneyBox.bankName}" class="textBoxStyle"/>
	  				<br></br>
	  				<p class="BankHead">Bank Account Number</p>
	  				<p:inputText value="#{loginBean.thisAccountMoneyBox.bankAccountNumber}" class="textBoxStyle"/>
	  				<br></br>
	  				<p class="BankHead">Bank Address</p>
	  				<p:inputText value="#{loginBean.thisAccountMoneyBox.bankAddress}" class="textBoxStyle"/>
	  				<br></br>
	  				<p class="BankHead">Bank Tel</p>
	  				<p:inputText value="#{loginBean.thisAccountMoneyBox.bankTelephone}" class="textBoxStyle"/>
	  				
	  				<br></br>
	  				<br></br>
	  				<br></br>
	  				
	  				<p:commandButton class="btn btn-default DTTT_button_print" value="Save" action="#{loginBean.saveBankAccountDetails}"/>
	  		</td>
	  			
	  		
	  		<td colspan="2">
	  			<p:panel id="amountTopay">
	  				<p class="BankHead">Total Amount to pay without fractions</p>
		  			<p:inputText  value="#{loginBean.amountToPayThroughPayPal}"  class="textBoxStyle"/>
		  			<br></br>
		  			<br></br>
		  			<p:commandButton value = "Click Here before Pay" update="amountTopay"></p:commandButton>	
		  			<br></br>
		  			<br></br>
		  			
		  			<p:outputLabel value="You will pay #{loginBean.amountToPayThroughPayPal}"></p:outputLabel>
		  			<div class="w-100">
		  				<div class="row">
		  					<div class="col-md-7">
		  						<div id="paypal-button-container" />
		  			
		  					</div>
		  					<div class="col-md-5">
	  		
							      <button type="button" id="checkout-button">Pay with Stripe</button>
							   
		  					</div>
		  				</div>
		  			</div>
		  			
		  			<script type="text/javascript">
    // Create an instance of the Stripe object with your publishable API key
    var stripe = Stripe("pk_test_2YQA8u5boAfuEBqV0x9Edn4n");
    var checkoutButton = document.getElementById("checkout-button");

    checkoutButton.addEventListener("click", function () {
      fetch("http://caromotolibya.com:8083/create-checkout-session.php?price=#{loginBean.amountToPayThroughPayPal}&amp;name=CaroMoto Services&amp;moneyBoxId=#{loginBean.thisAccountMoneyBox.id}&amp;amount=#{loginBean.amountToPayThroughPayPal}&amp;type= ", {
        method: "POST",
      })
        .then(function (response) {
        	console.log("Done1");
          return response.json();
        })
        .then(function (session) {
        	console.log("Done2");
          return stripe.redirectToCheckout({ sessionId: session.id });
        })
        .then(function (result) {
        	console.log("Done3");
          // If redirectToCheckout fails due to a browser or network
          // error, you should display the localized error message to your
          // customer using error.message.
          if (result.error) {
            alert(result.error.message);
          }
        })
        .catch(function (error) {
          console.error("Error:", error);
        });
    });
  </script>
  
					
						  			
				     <script>
				paypal.Buttons({
				    createOrder: function(data, actions) {
				      return actions.order.create({
				        purchase_units: [{
						
							description: 'Test description',
				            amount: {
				                currency_code: "USD",
				                value: '#{loginBean.amountToPayThroughPayPal}'
				             }
				          }]
				      });
				    },
				    onApprove: function(data, actions) {
				      return actions.order.capture().then(function(details) {
				    	  //activateMyAccount
				        
				        var amount=#{loginBean.amountToPayThroughPayPal};
						updatePayment([{name: 'paymentAmount', value: amount}, {name: 'data', value: 'NOTHING'}]);
						
				        // Call your server to save the transaction
				        
				      });
				    },
				          onError: function( err){
				        	  
				            console.log(err);
				          }
				  }).render('#paypal-button-container');
				</script>
	  			</p:panel>
	  			
	  		</td>
	  		
	  		
	  	</tr>
	  	
	  	
	  	
	  
	  	
	  	
	  	
	  	
	  
	  </table>
	  
	   <p:remoteCommand name="updatePayment" action="#{loginBean.addThisAmountToMyAccount}"/>
        




</div>
<div class="clr"></div>

</div>
                  </div>
              </div><!--/panel-body-->
          </div><!--/panel-->
    </div>
  </div>
</div>        
          


</div>
        </h:form>
	</ui:define>
	
		
	
</ui:composition>
</html>
